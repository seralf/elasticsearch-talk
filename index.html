<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Spantree - Elasticsearch</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/sky.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <link rel="stylesheet" href="custom_css/sublime_monokai.css">

    <!-- Spantree customizations -->
    <link rel="stylesheet" href="custom_css/spantree.css">
    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
    </script>

    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

        <!--INTRODUCTION-->
        <section>
          <section data-markdown id="title">
            <script type="text/template">
            Hey guys!

            ![Spantree logo](images/spantree.svg)

            is talking about

            ![Elasticsearch](images/elasticsearch.png)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template" class="logos">
              ## Who We Are

              <table class="ourpictures">
                <tr>
                  <td vertical-align="top">
                    ![Malynda](images/malynda.png)
                    <br/>
                    <p>Malynda Chizek Frouard</p>
                    <p>Junior Software Engineer</p>
                  </td>
                  <td>
                    ![Kevin](images/kevin.png)
                    <br/>
                    <p>Kevin Greene</p>
                    <p>Senior Software Engineer</p>
                  </td>
                  <td>
                    ![Cedric](images/cedric.png)
                    <br/>
                    <p>Cedric Hurst</p>
                    <p>Principal</p>
                  </td>
                  <td>
                    ![Gary](images/gary.png)
                    <br/>
                    <p>Gary Turovsky</p>
                    <p>Senior Software Engineer</p>
                  </td>
                </tr>
                <tr>
                  <td>
                    ![Allie](images/allie.png)
                    <br/>
                    <p>Allie Curry</p>
                    <p>Senior Software Engineer</p>
                  </td>
                  <td vertical-align="top">
                    ![Roberto](images/roberto.png)
                    <br/>
                    <p>Roberto Guerra</p>
                    <p>Senior Software Engineer</p>
                  </td>
                  <td>
                    ![Andrea](images/andrea.png)
                    <br/>
                    <p>Andrea Schuster</p>
                    <p>Director of Operations</p>
                  </td>
                  
                <tr>
              </table>
            </script>
          </section>
          <section data-markdown class="logos">
            <script type="text/template" >
              ## What We Work On

              ![Arena](images/arena.png)
              ![Chicago.com](images/chicagocom.png)
              ![NMH](images/nmh.gif)
              ![Channel company](images/channelcompany.gif)
              ![Doejo](images/doejo.png)
              ![MileIQ](images/mileiq.png)
              ![High School Cube](images/highschoolcube.png)
              ![Hosted Buyer](images/hostedbuyer.png)
              ![Wrapports](images/wrapports.png)
              ![GoHealth](images/gohealth.png)
              ![Mobiquity](images/mobiquity.png)
              ![Panera](images/panera.png)
            </script>
          </section>
          <section data-markdown class="logos">
            ## Stuff We Use

            ![Amazon Web Services](images/aws.svg)
            ![Github](images/github.svg)
            ![Vagrant](images/vagrant.png)
            ![Puppet](images/puppet.svg)

            ![PostgreSQL](images/postgres.svg)
            ![MongoDB](images/mongodb.png)
            ![Neo4J](images/neo4j.svg)
            ![Elasticsearch](images/elasticsearch.png)

            ![Java](images/java.svg)
            ![Groovy](images/groovy.svg)
            ![Grails](images/grails.svg)
            ![Marionette.js](images/marionettejs.png)


            ![Dojo](images/dojo.svg)
            ![jQuery](images/jquery.svg)
            ![Coffeescript](images/coffeescript.svg)
            ![Backbone.js](images/backbone.png)

          </section>
        </section>
        <section>
          <section data-markdown>
            <script type="text/template">
              ![Elasticsearch logo](images/elasticsearch.png)

              <p><img src="images/kimchy.jpeg" style="width:50px;vertical-align:text-top"> "You know, for Search!"</p>
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ![Cote Tweet](images/cote-tweet.png)
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ## The Challenge

              ![Simplicity](images/simplicity.png)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### How We Query

              #### SQL Database

              ```sql
              SELECT *
              FROM Person INNER JOIN Scientist ON Person.ID = Scientist.ID
              WHERE FirstName LIKE "Edgar%" And LastName = "Codd";
              ```

              #### MongoDB

              ```javascript
              db.spantree.find({firstName: "Eric", lastName: "Evans"});
              ```

              #### Elasticsearch

              ```json
              GET /spantree/_search

              {"query": { "bool": {"must": [
                {"query_string": {"query": "vannevar bush"}}
              ]}}}
              ```

              <!--TODO: Add Elasticsearch family tree-->
            </script>
          </section>
          
          <section data-markdown>
            <script type="text/template">
              ### What People Expect

              <table class="examples">
                <tbody>
                  <tr>
                    <th>Lowercase</th>
                    <td>iPhone</td>
                    <td>&#8781;</td>
                    <td>iphone</td>
                  </tr>
                  <tr>
                    <th>Stemming</th>
                    <td>Runner</td>
                    <td>&#8781;</td>
                    <td>Running</td>
                  </tr>
                  <tr>
                    <th>Synonyms</th>
                    <td>Car</td>
                    <td>&#8781;</td>
                    <td>Automobile</td>
                  </tr>
                  <tr>
                    <th>Word delimiters</th>
                    <td>Show-off</td>
                    <td>&#8781;</td>
                    <td>Show off</td>
                  </tr>
                  <tr>
                    <th>ASCII Folding</th>
                    <td>Nestl√©</td>
                    <td>&#8781;</td>
                    <td>Nestle</td>
                  </tr>
                  <tr>
                    <th>Pattern Replace</th>
                    <td>(888) 386-5501</td>
                    <td>&#8781;</td>
                    <td>888.386.5501</td>
                  </tr>
                  <tr>
                    <th>Edge NGram</th>
                    <td>ela</td>
                    <td>&#8781;</td>
                    <td>elasticsearch</td>
                  </tr>
                </tbody>
              </table>
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### What People Expect
              #### Searching Across Fields

              
              ```json
              {
                "product": {
                  "name": "nifty doodad",
                  "description": "this is an example"
                }
              }
              ```

              This document should match <em>example doodad</em>

              
              <!-- TODO: Fill in with multi-match example -->
            </script>
          </section>
        </section>
        <section class="screenshots">
          <section data-markdown>
            <script type="text/template">
              ## Elasticsearch Is...
            </script>
          </section>
          <section data-markdown class="screenshot-dark">
            <script type="text/template">
              ### Wicked Fast

              ![ApacheBench Results](images/ab-results.png)

              <!--TODO: Annotate with what the screenshot actually says-->
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### Highly Configurable

              ![HEAD Configuration](images/es-configurable.png)
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### Free and Open Source

              ![ES Github Repo](images/es-github.png)
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### Distributed and Fault Tolerant

              ![ES Github Repo](images/es-karmi.png)
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### Good at Handling Lots of Data

              ![ES Github Big Data](images/es-big-data-github.png)
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### ...Also Works With Unstructured Data

              ![ES Hamlet](images/es-shakespeare-json.png)
            </script>
          </section>
          <section data-markdown class="screenshot-dark">
            <script type="text/template">
              ### ...And Real-Time Analytics

              ![ES Hamlet](images/logstash-search-screenshot.png)
            </script>
          </section>
        </section>
        <section>
          <section data-markdown>
            <script type="text/template">
              ## Elasticsearch Isn&#39;t...
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### A Relational Database

              ![PostgreSQL](images/postgres.svg)
            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### A Crawler

              ![Apache Nutch](images/nutch.png)
            </script>
          </section>
          <section data-markdown class="logos-big">
            <script type="text/template">
              ### A Machine Learner

              ![Apache Mahout](images/mahout.svg)
              ![Carrot2](images/carrot2.png)
            </script>
          </section>
          <section data-markdown class="logos-big">
            <script type="text/template">
              ### A User-Facing Search Experience

              ![Do It Yourself](images/do-it-yourself.svg)
            </script>
          </section>
          <section data-markdown class="logos-big">
            <script type="text/template">
              ### Secure

              ![Vault](images/safe.svg)
            </script>
          </section>
        </section>
        <section>
          <section data-markdown>
            <script type="text/template">
              ## How It Works
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### What does querying an index do?

              * Find the documents that match the query
              * Score the documents 

            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Finding matching documents

              * Query is a set of terms, Q
              * Each document has a set of terms, D
              * Find all D that intersect Q
              * We will need a special data structure
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Inverted index

              ![Book Index](images/book-index.png)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Inverted index

              * Maps word to document or position
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Finding the right document

              <table class="documents">
                <tr>
                  <th>0</th>
                  <th>1</th>
                  <th>2</th>
                </tr>
                <tr>
                  <td>
                    work it make it<br/>
                    do it makes us<br/>
                    harder better<br/>
                    faster stronger
                  </td>
                  <td>
                    more than hour,<br/>
                    hour never<br/>
                    ever after,<br/>
                    work is over
                  </td>
                  <td>
                    work it harder<br/>
                    make it better<br/>
                    do it faster<br/>
                    makes us stronger
                  </td>
                </tr>
              </table>
              <br/>
              <table style="margin: auto">
                <tr>
                  <td>work</td><td>&rarr;</td><td>0, 1, 2</td>
                </tr>
                <tr>
                  <td>hour</td><td>&rarr;</td><td>1</td>
                </tr>
                <tr>
                  <td>harder</td><td>&rarr;</td><td>0, 2</td>
                </tr>
              </table>

            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Finding position in document

              <table class="documents">
                <tr>
                  <th>0</th>
                  <th>1</th>
                  <th>2</th>
                </tr>
                <tr>
                  <td>
                    work it make it<br/>
                    do it makes us<br/>
                    harder better<br/>
                    faster stronger
                  </td>
                  <td>
                    more than hour,<br/>
                    hour never<br/>
                    ever after<br/>
                    work is over
                  </td>
                  <td>
                    work it harder<br/>
                    make it better<br/>
                    do it faster<br/>
                    makes us stronger
                  </td>
                </tr>
              </table>
              <br/>
              <table style="margin: auto">
                <tr>
                  <td rowspan="3">work</td><td rowspan="3">&rarr;</td><td>0:</td><td>{0}</td>
                </tr>
                <tr>
                  <td>1:</td><td>{7}</td>
                </tr>
                <tr>
                  <td>2:</td><td>{0}</td>
                </tr>
                <tr>
                  <td>hour</td><td>&rarr;</td><td>1:</td><td>{2, 3}</td>
                </tr>
                <tr>
                  <td rowspan="2">harder</td><td rowspan="2">&rarr;</td><td>0:</td><td>{8}</td>
                </tr>
                <tr>
                  <td>2:</td><td>{2}</td>
                </tr>
                <tr>
                  <td rowspan="3">it</td><td rowspan="3">&rarr;</td><td>0:</td><td>{1, 3, 5}</td>
                </tr>
                <tr>
                  <td>2:</td><td>{1, 4, 7}</td>
                </tr>
              </table>
              <br/>
              Does "work it" occur in a document?
            </script>
          </section>
          

          <section data-markdown data-separator="^\n===\n$" data-vertical="^\n---\n$">
            <script type="text/template">
              ### TF-IDF Scoring Of Documents
              $tf \times idf = tf \times \log{ \frac{N}{df} }$

              * <em>term frequency ($tf$)</em> number of times a term occurs in a particular document
              * <em>document frequency ($df$)</em> number of all documents a term occurs in 
              * <em>inverse document frequency ($idf$)</em> is (usually) $\log{\frac{N}{df}}$, where $N$ is the number of documents in the index

            </script>
          </section>
          <section data-markdown data-separator="^\n===\n$" data-vertical="^\n---\n$">
            <script type="text/template">
              ### Scoring our example

              <table style="margin: auto">
                <tr>
                  <td rowspan="3">work</td><td rowspan="3">&rarr;</td><td>0:</td><td>{0}</td>
                </tr>
                <tr>
                  <td>1:</td><td>{7}</td>
                </tr>
                <tr>
                  <td>2:</td><td>{0}</td>
                </tr>
                <tr>
                  <td>hour</td><td>&rarr;</td><td>1:</td><td>{2, 3}</td>
                </tr>
                <tr>
                  <td rowspan="2">harder</td><td rowspan="2">&rarr;</td><td>0:</td><td>{8}</td>
                </tr>
                <tr>
                  <td>2:</td><td>{2}</td>
                </tr>
              </table>


              <table class="tf-idf">
                <tr>
                  <th></th>
                  <th>work</th>
                  <th>hour</th>
                  <th>harder</th>
                </tr>
                <tr>
                  <td>0:</td><td>$1 \times \log{\frac{3}{3}}$</td><td>$0 \times \log{\frac{3}{1}}$</td><td>$1 \times \log{\frac{3}{2}}$</td>
                </tr>
                <tr>
                  <td>1:</td><td>$1 \times \log{\frac{3}{3}}$</td><td>$2 \times \log{\frac{3}{1}}$</td><td>$0 \times \log{\frac{3}{2}}$</td>
                </tr>
                <tr>
                  <td>2:</td><td>$1 \times \log{\frac{3}{3}}$</td><td>$0 \times \log{\frac{3}{1}}$</td><td>$1 \times \log{\frac{3}{2}}$</td>
                </tr>
              <table>
            </script>
          </section>
          <section data-markdown data-separator="^\n===\n$" data-vertical="^\n---\n$">
            <script type="text/template">
              ### Scoring our example
              <table class="scoring">
                <tr>
                  <th></th>
                  <th>work</th>
                  <th>hour</th>
                  <th>harder</th>
                </tr>
                <tr>
                  <td>0:</td><td>0</td><td>0</td><td>.35</td>
                </tr>
                <tr>
                  <td>1:</td><td>0</td><td>.95</td><td>0</td>
                </tr>
                <tr>
                  <td>2:</td><td>0</td><td>0</td><td>.35</td>
                </tr>
              <table>
              <br/>

              * Create a vector for the query: $\[1,1,1\]$
              * Take the cosine-similarity of the two vectors
                * Gives the cosine of the angle between two vectors
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### The Lucene Library

              ![Lucene](images/lucene.png)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### How it *really* works

              * [http://lucene.apache.org/core/4_0_0/core/overview-summary.html](http://lucene.apache.org/core/4_0_0/core/overview-summary.html)
              * [http://wiki.apache.org/lucene-java/LucenePapers](http://wiki.apache.org/lucene-java/LucenePapers)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Terminology Overview

              ![Index Structure](images/index-structure.svg)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Indexes

              One or more Lucene indexes, composed of segments

            </script>
          </section>
          <section data-markdown class="screenshot">
            <script type="text/template">
              ### Lucene segement merging in action
              <iframe width="560" height="315" src="//www.youtube.com/embed/YW0bOvLp72E?rel=0" frameborder="0" allowfullscreen></iframe>
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Documents

              ```json
              {
                "_index": "index_name",
                "_type": "document_type",
                "_id": 1337,
                "_source": {
                  "field0": 777,
                  "field1": "value",
                  "field2": ["value1","value2","value3"],
                  "field3": {
                    "subfield0":"value1",
                    "subfield1":"value2"
                  } 
                }
              }
              ```
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Types and Mappings
              * The fields a document should have
              * The data type of each field
              * Analysis
                * How to generate tokens from document (indexing)
                * How to generate tokens from query string (searching)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Data Types

              * string
              * integer/long
              * float/double
              * boolean
              * ip
              * geo point
              * geo shape
              * attachment
              * object
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Analyzer

              ![Analysis phases](images/analysis-chain.svg)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Mappings and analysis

              ![Mapping and analysis](images/mapping-analysis.svg)
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Clustering: Sharding and Replication

              * <em>Shard</em> - Single Lucene index (portion of Elasticsearch index)
                * More shards means better write performance
              * <em>Replica</em> - Copy of a shard
                * More replicas means faster queries
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Example

              ![Analysis phases](images/sharding-replica.svg)
            </script>
          </section>
        </section>
        <section>
          <section data-markdown>
            <script type="text/template">
              ## Indexing
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Anatomy of a Request

              ```bash
              curl -XPUT 'http://esdemo.local:9200/wikipedia/location/1' -d '{
                "name": "Spantree Technology Group, LLC",
                "about" : "Spantree is a boutique, Chicago-based consultancy delivering intelligent, high quality software solutions for the web.",
                "lastUpdated":"2013-12-30T02:14:41+0000",
                "yearFounded":2009
              }'
              ```

              </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Automatic Mappings

              ![AutomaticMapping](images/automatic-mapping.png)              
              </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Create or Update Document

              ```bash
              curl -XPUT 'http://esdemo.local:9200/wikipedia/location/1' -d '{
                "name": "Spantree Technology Group, LLC",
                "about" : "Spantree is a boutique, Chicago-based consultancy delivering intelligent, high quality software solutions for the web.",
                "lastUpdated":"2013-12-30T02:14:41+0000",
                "yearFounded":2009
              }'
              ```

              ```bash

              curl -XPOST 'http://esdemo.local:9200/wikipedia/location/' -d '{
                "name": "Spantree Technology Group, LLC",
                "about" : "Spantree is a boutique, Chicago-based consultancy delivering intelligent, high quality software solutions for the web.",
                "lastUpdated":"2013-12-30T02:14:41+0000",
                "yearFounded":2009
              }'
              ```
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Update API
              
              ```bash
              curl -XPOST 'http://esdemo.local:9200/wikipedia/location/1/_update' -d '{
                "script": "ctx._source.lastUpdated = date",
                "params": {
                  "date": "2014-02-18T02:14:41+0000"
                }
              }'
              ```

              ```bash
              curl -XPOST 'http://esdemo.local:9200/wikipedia/location/1/_update' -d '{
                "doc": {
                  "date": "2014-02-18T02:14:41+0000"
                }
              }'
              ```



              </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Bulk API
       
              ```bash
              $ cat divvy.json

              {"index": {"_type": "station", "_id": "119"}}
              {"capacity": 15, "name": "Lake Park Ave & 56th St", "location": {"lat": 41.793242, "lon": -87.587782}}
              {"index": {"_type": "station", "_id": "353"}}
              {"capacity": 15, "name": "Ada St & Washington Blvd", "location": {"lat": 41.88283, "lon": -87.661206}}
              ```

              ```bash
              curl -f -s -S -XPOST --data-binary "@divvy.json" http://esdemo.local:9200/divvy/_bulk
              ```
            </script>
          </section>
        </section>
        <section>
          <section data-markdown>
            <script type="text/template">
              ## Querying
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Search API

              ```bash
              curl -XGET http://esdemo.local:9200/wikipedia/_search?q=about:lake
              ```

              or

              ```bash
              curl -XGET http://esdemo.local:9200/wikipedia/_search -d '{
                "query" : {
                  "term" : { "about" : "lake" }
                }
              }
              ```
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              <h3>Types of Queries</h3>

              <table>
              <tr><td>match</td><td>multi match </td><td> bool</td><tr>                

              <tr><td> boosting  </td><td> common terms </td><td nowrap> constant score </td><tr> 
             <tr><td>  dis max  </td><td>filtered  </td><td> fuzzy like this </td><tr> 
             <tr><td>  fuzzy like this field </td><td> function score </td><td> fuzzy </td><tr> 
             <tr><td>  geoshape </td><td>has child  </td><td>has parent </td><tr> 
           <tr><td>    ids </td><td>indices  </td><td>  match all </td><tr> 
             <tr><td>  more like this </td><td>  more like this field  </td><td> nested </td><tr> 
             <tr><td>   prefix </td><td> query string   </td><td>  simple query </td><tr> 
            <tr><td>    range</td><td> regexp   </td><td> span first </td><tr> 
         <tr><td>      span multi term  </td><td> span near  </td><td> span not </td><tr> 
           <tr><td>     span or  </td><td> span term  </td><td> term </td><tr> 
            <tr><td>   terms </td><td> top children  </td><td> wildcard</td><tr> 
            <tr><td nowrap>   minimum should match  </td><td nowrap> multi term query rewrite</td><tr> 
              </table>
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              <h3>Types of Queries</h3>

              <table>
              <tr><td>match</td><td><b>multi match </b> </td><td> <b> bool </b></td><tr>                

              <tr><td> <b>boosting </b>  </td><td> common terms </td><td nowrap> constant score </td><tr> 
             <tr><td>  dis max  </td><td>filtered  </td><td> fuzzy like this </td><tr> 
             <tr><td>  fuzzy like this field </td><td> function score </td><td> fuzzy </td><tr> 
             <tr><td>  geoshape </td><td>has child  </td><td>has parent </td><tr> 
           <tr><td>    ids </td><td>indices  </td><td>  match all </td><tr> 
             <tr><td>  more like this </td><td>  more like this field  </td><td> nested </td><tr> 
             <tr><td>   prefix </td><td> query string   </td><td>  simple query </td><tr> 
            <tr><td>   <b> range </b></td><td> regexp   </td><td> span first </td><tr> 
         <tr><td>      span multi term  </td><td> span near  </td><td> span not </td><tr> 
           <tr><td>     span or  </td><td> span term  </td><td> <b>term </b> </td><tr> 
            <tr><td>   terms </td><td> top children  </td><td> wildcard</td><tr> 
            <tr><td nowrap>   minimum should match  </td><td nowrap> multi term query rewrite</td><tr> 
              </table>
            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
              ### Scoring

              * Defaults to TF/IDF
              * Modified via boosting
              * Can rewrite scoring engine

              </script>
          </section>
          <section data-markdown>
            <script type="text/template">
            ### Queries vs Filters

            <table class="qvf">
            <tr>
              <th>Queries</th>
              <th>Filters</th>
            </tr>
            <tr>
              <td>Fuzzy</td>
              <td>Boolean</td>
            </tr>
            <tr>
              <td>Slower</td>
              <td>Faster</td>
            </tr>
            <tr>
              <td>Never cached</td>
              <td>Cacheable</td>
            </tr>
            </table>

            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Filter on Red and Green

              ![Ornaments](images/red-and-green-ornaments.jpg)
              ![MM](images/red-green-m-m.jpg)
              ![RedGreen](images/red_green.jpg)



            </script>
          </section>

          <section data-markdown>
            <script type="text/template">
              ### Query on Red and Green - Also returns

              ![Red](images/red.png)
              ![Green](images/green.png)
              ![Blue](images/blue.svg)


            </script>
          </section>


          <section data-markdown>
            <script type="text/template">
              ### Facets

              ![Amazon](images/amazon-java.png)
              ![Airbnb](images/airbnb.png)

              </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Aggregations

              * The new facets
              * Allow for hierarchical data analysis

              </script>
          </section>

        </section>
        <section>
          <section data-markdown>
            <script type="text/template">
              ## Java API
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Installing

              ```xml
              <dependency>
                <groupId>org.elasticsearch</groupId>
                <artifactId>elasticsearch</artifactId>
                <version>1.0.0</version>
              </dependency>
            
              ```

              </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Connecting
                ```
                import static org.elasticsearch.node.NodeBuilder.*;

                // on startup

                Node node = nodeBuilder().node();
                Client client = node.client();

                // on shutdown

                node.close();
                ```
              <!-- TODO: Fill in with ES Client setup boilerplate for Java  -->
            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Indexing
              ```java
              import static org.elasticsearch.common.xcontent.XContentFactory.*;
              

              IndexResponse response = client.prepareIndex("wikipedia", "locations", "lake_point_tower")
                  .setSource(jsonBuilder()
                    .startObject()
                        .field("name", "Lake Point Tower")
                        .field("external_links", "http://rdf.freebase.com/ns/m/07k2z6")
                        .field("keywords", ["residential","skyscrapers"])
                    .endObject()
                  )
                  .execute()
                  .actionGet();
              ```

              ```bash
              curl -XPUT 'http://localhost:9200/wikipedia/locations/lake_point_tower' -d '{
                "locations" : {
                    "properties" : {
                      "name" : "Lake Point Tower",
                      "external_links" : "http://rdf.freebase.com/ns/m/07k2z6",
                      "keywords" : ["residential","skyscrapers"]
                    }
                }
              }'
              ```

            </script>
          </section>
          <section data-markdown>
            <script type="text/template">
              ### Querying


              ```java
              import org.elasticsearch.action.search.SearchResponse;
              import org.elasticsearch.action.search.SearchType;
              import org.elasticsearch.index.query.QueryBuilders.*;
              SearchResponse response = client.prepareSearch("wikipedia")
                .setTypes("locations")
                .setSearchType(SearchType.DFS_QUERY_THEN_FETCH)
                .setQuery(QueryBuilders.termQuery("name", "lake")) // Query
                .execute()
                .actionGet();
              ```

              ```bash
              curl -XGET 'http:localhost:9200/wikipedia/locations/' -d '{
                "query" : {  
                   "term" : { "name" : "lake"}
                  }
              }'
              ```

            </script>
          </section>
        </section>
        <section data-markdown>
            <script type="text/template">
              ## Demo Time
            </script>
        </section>
        <section>
          <h3>Have fun with Elasticsearch!</h3>
          <iframe class="vine-embed" src="https://vine.co/v/M7rdWEdIrtq/embed/simple" width="600" height="600" frameborder="0"></iframe>
        </section>
      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>
    <script src="https://platform.vine.co/static/scripts/embed.js" charset="utf-8"></script>
    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          {
            src: 'lib/js/classList.js',
            condition: function() { return !document.body.classList; }
          },
          {
            src: 'plugin/markdown/marked.js',
            condition: function() { return !!document.querySelector( '[data-markdown]' ); }
          },
          {
            src: 'plugin/markdown/markdown.js',
            condition: function() { return !!document.querySelector( '[data-markdown]' ); }
          },
          {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function() { hljs.initHighlightingOnLoad(); }
          },
          {
            src: 'plugin/zoom-js/zoom.js',
            async: true,
            condition: function() { return !!document.body.classList; }
          },
          {
            src: 'plugin/notes/notes.js',
            async: true,
            condition: function() { return !!document.body.classList; }
          },
          { 
            src: 'plugin/math/math.js', 
            async: true 
          }
        ]
      });

    </script>

  </body>
</html>
